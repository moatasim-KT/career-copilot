# =============================================================================
# Career Copilot Backend - Environment Configuration
# =============================================================================
# This file contains all configuration variables for the Career Co-Pilot backend.
# Copy this file to .env and update the values for your environment.
# =============================================================================

# =============================================================================
# Application Settings
# =============================================================================
# Environment mode: development, production, or testing
# Set to 'production' for deployment, 'development' for local work
ENVIRONMENT=development

# API server host (0.0.0.0 allows external connections, 127.0.0.1 for localhost only)
API_HOST=0.0.0.0

# API server port
API_PORT=8002

# Enable debug mode for FastAPI (shows detailed errors, enables interactive docs)
# IMPORTANT: Set to False in production for security
DEBUG=True

# =============================================================================
# Testing Configuration
# =============================================================================
# Test database URL - Uses PostgreSQL for accurate production testing
# The test database is automatically created/dropped during test runs
TEST_DATABASE_URL=postgresql://postgres:postgres@localhost:5432/career_copilot_test

# =============================================================================
# Job Board API Configurations
# =============================================================================

# Adzuna API Configuration
ADZUNA_APP_ID=your_adzuna_app_id
ADZUNA_APP_KEY=your_adzuna_app_key

# RapidAPI JSearch (aggregates LinkedIn/Indeed/Glassdoor without direct partnerships)
RAPIDAPI_JSEARCH_KEY=your_rapidapi_key

# The Muse Public API (optional key, enables higher rate limits)
THEMUSE_API_KEY=
THEMUSE_BASE_URL=https://www.themuse.com/api/public

# Indeed API Configuration
INDEED_API_KEY=your_indeed_api_key
INDEED_PUBLISHER_ID=your_indeed_publisher_id

# LinkedIn API Configuration
LINKEDIN_ACCESS_TOKEN=your_linkedin_access_token
LINKEDIN_CLIENT_ID=your_linkedin_client_id
LINKEDIN_CLIENT_SECRET=your_linkedin_client_secret

# GitHub Jobs API Configuration
GITHUB_ACCESS_TOKEN=your_github_access_token

# Firecrawl API (optional, enables JavaScript-heavy company career scraping)
FIRECRAWL_API_KEY=

# -----------------------------------------------------------------------------
# Web Scraping Controls (ScraperManager toggles)
# -----------------------------------------------------------------------------
# Max number of results fetched per enabled site (default 25)
SCRAPING_MAX_RESULTS_PER_SITE=25

# How many scrapers may run in parallel (affects CPU/network usage)
SCRAPING_MAX_CONCURRENT=2

# Toggle individual scrapers on/off depending on available credentials
SCRAPING_ENABLE_INDEED=false
SCRAPING_ENABLE_LINKEDIN=false
SCRAPING_ENABLE_ARBEITNOW=true
SCRAPING_ENABLE_BERLINSTARTUPJOBS=true
SCRAPING_ENABLE_RELOCATEME=true
SCRAPING_ENABLE_EURES=true
SCRAPING_ENABLE_FIRECRAWL=false
SCRAPING_ENABLE_LANDINGJOBS=true
SCRAPING_ENABLE_EUTECHJOBS=true
SCRAPING_ENABLE_EUROTECHJOBS=true
SCRAPING_ENABLE_AIJOBSNET=true
SCRAPING_ENABLE_DATACAREER=true
SCRAPING_ENABLE_EU_PLAYWRIGHT=false

# Rate limiting between scraper requests (seconds)
SCRAPING_RATE_LIMIT_MIN=1.0
SCRAPING_RATE_LIMIT_MAX=3.0

# =============================================================================
# Notification Services
# =============================================================================

# Email Configuration (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your_email@gmail.com
SMTP_PASSWORD=your_app_specific_password
SMTP_FROM_EMAIL=your_email@gmail.com
SMTP_FROM_NAME=Career Copilot

# Push Notifications (Firebase)
FIREBASE_PROJECT_ID=your_firebase_project_id
FIREBASE_PRIVATE_KEY=your_firebase_private_key
FIREBASE_CLIENT_EMAIL=your_firebase_client_email

# SMS Configuration (Twilio)
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_FROM_NUMBER=your_twilio_phone_number

# =============================================================================
# Database Configuration
# =============================================================================
# SQLAlchemy database connection URL (REQUIRED)
# Examples:
#   PostgreSQL (Development/Production): postgresql://user:password@host:port/database_name
#   Async Postgres for async drivers: postgresql+asyncpg://user:password@host:port/database_name
# IMPORTANT: SQLite support has been removed from this codebase. Please use PostgreSQL.
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/career_copilot

# Database pool size (number of connections to maintain)
# Recommended: 5-10 for development, 20-50 for production
DB_POOL_SIZE=10

# Database max overflow (additional connections beyond pool_size)
# Recommended: 10 for development, 20-30 for production
DB_MAX_OVERFLOW=20

# Database connection timeout in seconds
DB_POOL_TIMEOUT=30

# =============================================================================
# Redis Configuration (REQUIRED for production)
# =============================================================================
# Redis connection URL for caching, rate limiting, and Celery broker
# Format: redis://[:password]@host:port/db
# Examples:
#   Local development: redis://localhost:6379/0
#   With password: redis://:mypassword@localhost:6379/0
#   Redis Cloud: redis://:password@redis-12345.cloud.redislabs.com:12345/0
REDIS_URL=redis://localhost:6379/0

# Redis cache TTL (time to live) in seconds
# Default cache expiration time for cached data
# Recommended: 3600 (1 hour) for development, 1800 (30 min) for production
REDIS_CACHE_TTL=3600

# Redis connection pool size
# Number of Redis connections to maintain in the pool
# Recommended: 10 for development, 50 for production
REDIS_POOL_SIZE=10

# =============================================================================
# Celery Configuration (Background Tasks)
# =============================================================================
# Celery broker URL (typically same as Redis URL)
# Used for task queue management
CELERY_BROKER_URL=redis://localhost:6379/1

# Celery result backend URL (for storing task results)
# Used to retrieve results of completed tasks
CELERY_RESULT_BACKEND=redis://localhost:6379/2

# Celery worker concurrency (number of parallel task workers)
# Recommended: 2-4 for development, CPU count * 2 for production
CELERY_WORKER_CONCURRENCY=2

# Celery task time limit in seconds (hard limit)
# Tasks exceeding this limit will be terminated
# Recommended: 600 (10 minutes) for most tasks
CELERY_TASK_TIME_LIMIT=600

# Celery task soft time limit in seconds
# Warning is raised when this limit is reached
# Recommended: 540 (9 minutes) to allow graceful shutdown
CELERY_TASK_SOFT_TIME_LIMIT=540

# Enable Celery beat scheduler for periodic tasks
# Set to True to run scheduled tasks (job scraping, analytics reports, etc.)
CELERY_BEAT_ENABLED=True

# =============================================================================
# ChromaDB Configuration (Vector Store)
# =============================================================================
# ChromaDB persistence directory for vector embeddings
# Used for job similarity matching and recommendations
# Default: ./data/chroma
CHROMA_PERSIST_DIRECTORY=./data/chroma

# ChromaDB collection name for job embeddings
# Change if you want to use a different collection
CHROMA_COLLECTION_NAME=job_embeddings

# ==================== Authentication & Security ====================
JWT_SECRET_KEY=your-secret-key-here-change-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
DISABLE_AUTH=false

# Single-User Mode (for personal deployment)
SINGLE_USER_MODE=true
DEFAULT_USER_EMAIL=user@career-copilot.local
DEFAULT_USER_PASSWORD=changeme123
DEFAULT_USER_USERNAME=copilot_user

# --- CORS Configuration ---
# Comma-separated list of origins allowed to make requests to the API
# Example: http://localhost:3000,https://your-frontend.com
CORS_ORIGINS=http://localhost:8501,http://localhost:3000

# --- AI/LLM Service API Keys (Optional) ---
# API key for OpenAI services
OPENAI_API_KEY=
# API key for Anthropic services
ANTHROPIC_API_KEY=
# API key for Groq services
GROQ_API_KEY=

# =============================================================================
# OAuth Social Authentication (Optional)
# =============================================================================
# Enable/disable OAuth social authentication (default: False)
OAUTH_ENABLED=False

# --- Google OAuth Configuration ---
# Google OAuth 2.0 Client ID (from Google Cloud Console)
# Get from: https://console.cloud.google.com/apis/credentials
GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
# Google OAuth 2.0 Client Secret
GOOGLE_CLIENT_SECRET=your-google-client-secret
# Google OAuth redirect URI (must match registered URI)
GOOGLE_REDIRECT_URI=http://localhost:8002/api/v1/auth/oauth/google/callback

# --- LinkedIn OAuth Configuration ---
# LinkedIn OAuth Client ID (from LinkedIn Developer Portal)
# Get from: https://www.linkedin.com/developers/apps
LINKEDIN_CLIENT_ID=your-linkedin-client-id
# LinkedIn OAuth Client Secret
LINKEDIN_CLIENT_SECRET=your-linkedin-client-secret
# LinkedIn OAuth redirect URI (must match registered URI)
LINKEDIN_REDIRECT_URI=http://localhost:8002/api/v1/auth/oauth/linkedin/callback

# --- GitHub OAuth Configuration ---
# GitHub OAuth Client ID (from GitHub Developer Settings)
# Get from: https://github.com/settings/developers
GITHUB_CLIENT_ID=your-github-client-id
# GitHub OAuth Client Secret
GITHUB_CLIENT_SECRET=your-github-client-secret
# GitHub OAuth redirect URI (must match registered URI)
GITHUB_REDIRECT_URI=http://localhost:8002/api/v1/auth/oauth/github/callback

# =============================================================================
# Email & Notifications (Optional)
# =============================================================================
# Enable/disable email notifications (default: False)
# Set to True to enable morning briefings and evening summaries
# Requires SMTP configuration below
SMTP_ENABLED=False

# SMTP server hostname (e.g., smtp.gmail.com, smtp.sendgrid.net, smtp.office365.com)
SMTP_HOST=smtp.gmail.com

# SMTP server port
# Common ports: 587 (TLS/STARTTLS), 465 (SSL), 25 (unencrypted - not recommended)
SMTP_PORT=587

# SMTP authentication username (usually your email address)
# For Gmail, use your full email address
SMTP_USER=your-email@example.com

# SMTP authentication password
# For Gmail, use an app-specific password (not your regular password)
# Generate at: https://myaccount.google.com/apppasswords
SMTP_PASSWORD=your-email-password

# Email address to use as sender for notifications
# This will appear in the "From" field of emails
SMTP_FROM_EMAIL=noreply@career-copilot.com

# SendGrid API Key (alternative to SMTP configuration)
# If provided, SendGrid will be used instead of SMTP
SENDGRID_API_KEY=

# =============================================================================
# Task Scheduling & Automation
# =============================================================================
# Enable/disable the APScheduler background task scheduler (default: True)
# When enabled, runs automated tasks on schedule:
#   - Job ingestion: Daily at 4:00 AM
#   - Morning briefing: Daily at 8:00 AM
#   - Evening summary: Daily at 8:00 PM
ENABLE_SCHEDULER=True

# Enable/disable automatic job scraping from external APIs (default: False)
# When enabled, the system will automatically fetch jobs daily
# Requires JOB_API_KEY to be configured
ENABLE_JOB_SCRAPING=False

# API key for external job scraping services (e.g., Adzuna, Indeed)
# Required if ENABLE_JOB_SCRAPING is set to True
# Adzuna API: Get free key at https://developer.adzuna.com/
JOB_API_KEY=your-job-api-key

# --- Logging Settings ---
# Logging level (e.g., INFO, DEBUG, WARNING, ERROR)
LOG_LEVEL=INFO
