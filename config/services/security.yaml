# Security Service Configuration
service: security
enabled: true

# Authentication Configuration
authentication:
  # JWT Configuration
  jwt:
    enabled: true
    algorithm: "HS256"
    expiration_hours: 24
    refresh_enabled: true
    refresh_expiration_days: 7
    
  # API Key Authentication
  api_key:
    enabled: true
    header_name: "X-API-Key"
    query_param: "api_key"
    
  # OAuth Configuration (Optional)
  oauth:
    enabled: false
    providers:
      - "google"
      - "github"
      
# Authorization Configuration
authorization:
  # Role-Based Access Control
  rbac:
    enabled: true
    default_role: "user"
    roles:
      - name: "admin"
        permissions: ["*"]
      - name: "user"
        permissions: ["read", "upload", "analyze"]
      - name: "readonly"
        permissions: ["read"]
        
# Rate Limiting
rate_limiting:
  enabled: true
  
  # Global Rate Limits
  global:
    requests_per_minute: 100
    requests_per_hour: 1000
    
  # Per-User Rate Limits
  per_user:
    requests_per_minute: 60
    requests_per_hour: 500
    
  # Per-IP Rate Limits
  per_ip:
    requests_per_minute: 30
    requests_per_hour: 200
    
  # Endpoint-Specific Limits
  endpoints:
    "/api/v1/upload":
      requests_per_minute: 10
      requests_per_hour: 50
    "/api/v1/analyze":
      requests_per_minute: 20
      requests_per_hour: 100
      
# Input Validation
input_validation:
  enabled: true
  
  # File Upload Security
  file_upload:
    max_size_mb: 50
    allowed_types: ["pdf", "docx", "txt"]
    scan_for_malware: false
    quarantine_suspicious: true
    
  # Request Validation
  request:
    max_request_size_mb: 10
    validate_content_type: true
    sanitize_input: true
    
# CORS Configuration
cors:
  enabled: true
  allowed_origins:
    - "http://localhost:8501"
    - "http://127.0.0.1:8501"
  allowed_methods: ["GET", "POST", "PUT", "DELETE", "OPTIONS"]
  allowed_headers: ["*"]
  allow_credentials: true
  max_age: 86400
  
# Security Headers
security_headers:
  enabled: true
  
  headers:
    # Content Security Policy
    csp:
      enabled: true
      policy: "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"
      
    # HTTP Strict Transport Security
    hsts:
      enabled: true
      max_age: 31536000
      include_subdomains: true
      
    # X-Frame-Options
    x_frame_options:
      enabled: true
      value: "DENY"
      
    # X-Content-Type-Options
    x_content_type_options:
      enabled: true
      
    # X-XSS-Protection
    x_xss_protection:
      enabled: true
      
# Encryption
encryption:
  # Data at Rest
  at_rest:
    enabled: true
    algorithm: "AES-256-GCM"
    key_rotation_days: 90
    
  # Data in Transit
  in_transit:
    enabled: true
    min_tls_version: "1.2"
    cipher_suites: ["ECDHE-RSA-AES128-GCM-SHA256", "ECDHE-RSA-AES256-GCM-SHA384"]
    
# Audit Logging
audit:
  enabled: true
  
  # Events to Log
  events:
    authentication: true
    authorization: true
    data_access: true
    configuration_changes: true
    security_violations: true
    
  # Log Storage
  storage:
    file: "logs/audit/security.log"
    rotation: "daily"
    retention_days: 90
    
# Vulnerability Scanning
vulnerability_scanning:
  enabled: false
  
  # Dependency Scanning
  dependencies:
    enabled: true
    schedule: "weekly"
    
  # Container Scanning
  containers:
    enabled: false
    registry_scanning: false
    
# Incident Response
incident_response:
  enabled: true
  
  # Automated Response
  automated:
    block_suspicious_ips: true
    quarantine_malicious_files: true
    alert_on_anomalies: true
    
  # Notification
  notification:
    channels: ["slack", "email"]
    severity_threshold: "medium"
    
# Compliance
compliance:
  # GDPR
  gdpr:
    enabled: false
    data_retention_days: 365
    anonymization: true
    
  # SOC 2
  soc2:
    enabled: false
    access_logging: true
    change_management: true
    
# Environment Overrides
environments:
  development:
    rate_limiting:
      enabled: false
    security_headers:
      csp:
        policy: "default-src 'self' 'unsafe-inline' 'unsafe-eval'"
    audit:
      events:
        data_access: false
        
  production:
    rate_limiting:
      enabled: true
    security_headers:
      enabled: true
    encryption:
      at_rest:
        enabled: true
      in_transit:
        enabled: true
    audit:
      enabled: true
      retention_days: 365
      
  testing:
    enabled: false